{% extends 'base.html' %}

{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/reservar.css' %}?v=1.3">
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/calcular_precio_total.js' %}" defer></script>
<script src="{% static 'js/combrobacion_valores_form_reserva.js' %}?v=1.1" defer></script>
{% endblock %}

{% block titulo %}TravelDream - Reservas{% endblock %}

{% block contenido %}
<div class="container">
    <div class="card">
        <h2 class="title">Reservar Viaje</h2>

        <!-- Información del Viaje -->
        <div class="info">
            <strong>{{ viaje.destino.nombre }}</strong><br>
            {{ viaje.fecha_salida|date:"d/m/Y" }} - {{ viaje.fecha_regreso|date:"d/m/Y" }}<br>
            Precio base: €{{ viaje.precio }}<br>
            Plazas disponibles: {{ viaje.calcular_plazas_disponibles}}
        </div>

        <form method="POST" action="{% url 'confirmar_reserva' viaje.viajeID %}">
            {% csrf_token %}
            
            <!-- Sección de Datos Personales -->
            <div class="form-section">
                <h3>Datos Personales</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Nombre *</label>
                        <input type="text" id="nombre" name="nombre" required>
                    </div>
                    <div class="form-group">
                        <label>Apellido *</label>
                        <input type="text" id="apellido" name="apellido" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" id= "email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label>Teléfono *</label>
                        <input type="tel" id = "telefono" name="telefono" required>
                    </div>
                </div>
            </div>

            <!-- Sección de Pago -->
            <div class="form-section">
                <h3>Información de Pago</h3>
                
                <div class="form-group">
                    <label>Número de Tarjeta *</label>
                    <input type="text" id="cc_numero" name="cc_numero" placeholder="1234 5678 9012 3456" required maxlength="19">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Fecha Expiración *</label>
                        <input type="text" id="cc_expiracion" name="cc_expiracion" placeholder="MM/AA" required maxlength="5">
                    </div>
                    <div class="form-group">
                        <label>CVV *</label>
                        <input type="text" id ="cc_cvv" name="cc_cvv" placeholder="123" required maxlength="3">
                    </div>
                </div>
            </div>

            <!-- Opciones Adicionales -->
            <div class="form-section">
                <h3>Opciones Adicionales</h3>
                
                <div class="form-group">
                    <div class="checkbox">
                        <input type="checkbox" name="seguro_viaje" id="seguro">
                        <label for="seguro">Seguro de viaje (+€50)</label>
                    </div>
                </div>
            </div>
        
            <div class="total-section">
                <div class="total">
                    Total: €<span id="total">{{ viaje.precio }}</span>
                </div>
            
                {% if viaje.calcular_plazas_disponibles > 0 %}
                    <button type="submit" class="btn">Confirmar y Pagar</button>
                {% else %}
                    <div class="error">No hay plazas disponibles</div>
                {% endif %}
            </div>
        </form>
    </div>
</div>
{% endblock %}